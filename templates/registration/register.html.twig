{% extends 'base.html.twig' %}

{% block title %}Créer un compte - Écuries des 4 Routes{% endblock %}

{% block body %}
    <section class="py-5">
        <div class="container">
            <!-- Messages flash avec style uniforme -->
            {% for flash_error in app.flashes('verify_email_error') %}
                <div class="alert alert-danger mb-4" role="alert" style="background: rgba(220, 53, 69, 0.1); border: 2px solid var(--error-color); border-radius: 12px; color: var(--error-color);">
                    <i class="bi bi-exclamation-triangle me-2"></i>{{ flash_error }}
                </div>
            {% endfor %}
            {% for flash_warning in app.flashes('warning') %}
                <div class="alert alert-warning mb-4" role="alert">
                    <i class="bi bi-exclamation-triangle me-2"></i>{{ flash_warning }}
                </div>
            {% endfor %}

            <!-- En-tête avec style uniforme -->
            <div class="text-center mb-5">
                <h1 class="text-primary-brand mb-3">
                    <i class="bi bi-person-plus" style="color: var(--accent-color);"></i>
                    Créer un compte
                    <i class="bi bi-person-plus" style="color: var(--accent-color);"></i>
                </h1>
                <div style="height: 3px; width: 200px; background: linear-gradient(90deg, var(--primary-color), var(--accent-color), var(--primary-color)); margin: 0 auto; border-radius: 2px;"></div>
                <p class="mt-3" style="color: var(--text-secondary);">
                    Rejoignez notre communauté équestre
                </p>
            </div>

            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card-modern">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3 class="text-primary-brand mb-0">
                                <i class="bi bi-form me-2"></i>Formulaire d'inscription
                            </h3>
                            <span class="badge bg-success">
                                <i class="bi bi-star me-1"></i>Nouveau membre
                            </span>
                        </div>

                        <!-- Message d'information -->
                        <div class="form-text-modern mb-4">
                            <i class="bi bi-info-circle me-2"></i>
                            Remplissez tous les champs pour créer votre compte.
                            Les champs marqués d'un astérisque (*) sont obligatoires.
                        </div>

                        <!-- Erreurs générales du formulaire -->
                        {% if registrationForm.vars.errors|length > 0 %}
                            <div class="alert alert-danger mb-4" style="background: rgba(220, 53, 69, 0.1); border: 2px solid var(--error-color); border-radius: 12px;">
                                <h5 class="alert-heading">
                                    <i class="bi bi-exclamation-triangle me-2"></i>Erreurs détectées
                                </h5>
                                {{ form_errors(registrationForm) }}
                            </div>
                        {% endif %}

                        {{ form_start(registrationForm, {'attr': {'class': 'form-modern', 'novalidate': 'novalidate'}}) }}

                        <div class="row g-4">
                            <!-- Colonne gauche -->
                            <div class="col-md-6">
                                <!-- Email -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.email, null, {'label_attr': {'class': 'form-label-modern required'}}) }}
                                    {{ form_widget(registrationForm.email, {'attr': {'class': 'form-control-modern', 'placeholder': 'exemple@email.com'}}) }}
                                    {{ form_errors(registrationForm.email) }}
                                </div>

                                <!-- Nom -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.nom, null, {'label_attr': {'class': 'form-label-modern required'}}) }}
                                    {{ form_widget(registrationForm.nom, {'attr': {'class': 'form-control-modern', 'placeholder': 'Votre nom de famille'}}) }}
                                    {{ form_errors(registrationForm.nom) }}
                                </div>

                                <!-- Prénom -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.prenom, null, {'label_attr': {'class': 'form-label-modern required'}}) }}
                                    {{ form_widget(registrationForm.prenom, {'attr': {'class': 'form-control-modern', 'placeholder': 'Votre prénom'}}) }}
                                    {{ form_errors(registrationForm.prenom) }}
                                </div>

                                <!-- Adresse -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.adresse, null, {'label_attr': {'class': 'form-label-modern required'}}) }}
                                    {{ form_widget(registrationForm.adresse, {'attr': {'class': 'form-control-modern', 'placeholder': 'Votre adresse complète'}}) }}
                                    {{ form_errors(registrationForm.adresse) }}
                                </div>

                                <!-- Date de naissance -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.dateNaissance, null, {'label_attr': {'class': 'form-label-modern required'}}) }}
                                    {{ form_widget(registrationForm.dateNaissance, {'attr': {'class': 'form-control-modern'}}) }}
                                    {{ form_errors(registrationForm.dateNaissance) }}
                                    <div class="form-text-modern">
                                        <i class="bi bi-calendar me-1"></i>
                                        Format : JJ/MM/AAAA
                                    </div>
                                </div>
                            </div>

                            <!-- Colonne droite -->
                            <div class="col-md-6">
                                <!-- Téléphone -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.telephone, null, {'label_attr': {'class': 'form-label-modern required'}}) }}
                                    {{ form_widget(registrationForm.telephone, {'attr': {'class': 'form-control-modern', 'placeholder': '0X XX XX XX XX'}}) }}
                                    {{ form_errors(registrationForm.telephone) }}
                                </div>

                                <!-- Niveau -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.niveau, null, {'label_attr': {'class': 'form-label-modern required'}}) }}
                                    {{ form_widget(registrationForm.niveau, {'attr': {'class': 'form-select-modern form-control-modern'}}) }}
                                    {{ form_errors(registrationForm.niveau) }}
                                    <div class="form-text-modern">
                                        <i class="bi bi-star me-1"></i>
                                        Sélectionnez votre niveau d'équitation
                                    </div>
                                </div>

                                <!-- Téléphone personne de contact -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.telPersContact, null, {'label_attr': {'class': 'form-label-modern'}}) }}
                                    {{ form_widget(registrationForm.telPersContact, {'attr': {'class': 'form-control-modern', 'placeholder': '0X XX XX XX XX'}}) }}
                                    {{ form_errors(registrationForm.telPersContact) }}
                                    <div class="form-text-modern">
                                        <i class="bi bi-person me-1"></i>
                                        En cas d'urgence (optionnel)
                                    </div>
                                </div>

                                <!-- Allergies -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.allergies, null, {'label_attr': {'class': 'form-label-modern'}}) }}
                                    {{ form_widget(registrationForm.allergies, {'attr': {'class': 'form-control-modern', 'placeholder': 'Précisez vos allergies si vous en avez'}}) }}
                                    {{ form_errors(registrationForm.allergies) }}
                                    <div class="form-text-modern">
                                        <i class="bi bi-heart-pulse me-1"></i>
                                        Important pour votre sécurité (optionnel)
                                    </div>
                                </div>
                                <!-- Numéro de licence -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.NoLicence, null, {'label_attr': {'class': 'form-label-modern'}}) }}
                                    {{ form_widget(registrationForm.NoLicence, {'attr': {'class': 'form-control-modern', 'placeholder': 'Votre numéro de licence FFE'}}) }}
                                    {{ form_errors(registrationForm.NoLicence) }}
                                    <div class="form-text-modern">
                                        <i class="bi bi-card-text me-1"></i>
                                        Numéro de licence FFE (optionnel)
                                    </div>
                                </div>

                                <!-- Mot de passe -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.plainPassword.first, null, {'label_attr': {'class': 'form-label-modern required'}}) }}
                                    {{ form_widget(registrationForm.plainPassword.first, {'attr': {'class': 'form-control-modern', 'placeholder': 'Minimum 8 caractères, 1 majuscule, 1 chiffre ou spécial'}}) }}
                                    {{ form_errors(registrationForm.plainPassword.first) }}
                                    <div class="form-text-modern">
                                        <i class="bi bi-lock me-1"></i>
                                        Au minimum 8 caractères, dont une majuscule et un chiffre ou un caractère spécial
                                    </div>
                                </div>

                                <!-- Confirmation mot de passe -->
                                <div class="form-group-modern">
                                    {{ form_label(registrationForm.plainPassword.second, null, {'label_attr': {'class': 'form-label-modern required'}}) }}
                                    {{ form_widget(registrationForm.plainPassword.second, {'attr': {'class': 'form-control-modern', 'placeholder': 'Retapez votre mot de passe'}}) }}
                                    {{ form_errors(registrationForm.plainPassword.second) }}
                                </div>
                            </div>
                        </div>

                        <!-- Section des checkboxes -->
                        <div class="mt-4 p-4" style="background: var(--bg-tertiary); border-radius: 12px; border: 2px solid var(--border-color);">
                            <h5 class="text-primary-brand mb-3">
                                <i class="bi bi-check-square me-2"></i>Autorisations et conditions
                            </h5>

                            <div class="row g-3">
                                <!-- Droit à l'image -->
                                <div class="col-12">
                                    <div class="form-check" style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                        {{ form_widget(registrationForm.droitImage, {'attr': {'class': 'form-check-input'}}) }}
                                        {{ form_label(registrationForm.droitImage, null, {'label_attr': {'class': 'form-check-label'}}) }}
                                        {{ form_errors(registrationForm.droitImage) }}
                                        <div class="form-text-modern mt-2">
                                            <i class="bi bi-camera me-1"></i>
                                            Cette autorisation nous permet de prendre des photos lors des activités équestres
                                        </div>
                                    </div>
                                </div>

                                <!-- Conditions d'utilisation -->
                                <div class="col-12">
                                    <div class="form-check" style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                        {{ form_widget(registrationForm.agreeTerms, {'attr': {'class': 'form-check-input'}}) }}
                                        {{ form_label(registrationForm.agreeTerms, null, {'label_attr': {'class': 'form-check-label'}}) }}
                                        {{ form_errors(registrationForm.agreeTerms) }}
                                        <div class="form-text-modern mt-2">
                                            <i class="bi bi-file-text me-1"></i>
                                            En cochant cette case, vous acceptez nos conditions d'utilisation et notre politique de confidentialité
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Bouton de soumission -->
                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-modern-primary" style="min-width: 200px;">
                                <i class="bi bi-person-check me-2"></i>Créer mon compte
                            </button>
                        </div>

                        {{ form_end(registrationForm) }}
                    </div>

                    <!-- Card avec liens utiles -->
                    <div class="card-modern mt-4">
                        <div class="text-center">
                            <h5 class="text-primary-brand mb-3">
                                <i class="bi bi-question-circle me-2"></i>Vous avez déjà un compte ?
                            </h5>
                            <a href="{{ path('app_login') }}" class="btn btn-outline-modern">
                                <i class="bi bi-box-arrow-in-right me-2"></i>Se connecter
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}